# 反无人机场景下轻量化实时目标检测算法研究

研究《You only look once: unified, real-time object detection》、《Spatial pyramid pooling in deep convolutional networks for visual recognition》等经典的YOLO目标检测算法。

首先，熟练掌握PyTorch深度学习框架，完成对反无人机领域视觉目标检测算法的全面调研，明确其对远距离小目标检测、低虚警率（特别是与鸟类区分）及高实时性的核心需求；

其次，掌握YOLO系列算法从v1-v3的基础架构到v4/v5的Bag-of-Freebies优化策略及v8/v10的anchor-free改进机理，同时学习先进的轻量化网络设计思想（如GhostNet、ShuffleNet）与注意力机制（如SE、CBAM、EMA）；

最后，阅读CVPR、ICCV等顶级会议中关于小目标检测与模型轻量化的相关论文，在YOLOv13或最新框架的基础上，对其骨干网络、颈部、头部进行针对性改进。设计融合深度可分离卷积与高效混合注意力机制的轻量化骨干网络、增强浅层特征传导的小目标敏感颈部结构和解耦检测头，重点研究如何平衡模型精度与速度，有效提升对远距离微小无人机目标的检出率，并显著降低在复杂天空背景下的鸟类误检，确保算法在边缘计算设备上的实时推理能力。
**实验平台**：算法研究完成后，先输入大量验证集测试算法效果（Python），再将训练好的模型部署于英伟达Jetson Orin NX等嵌入式边缘计算设备，并与工业级相机集成，构建一套轻量化验证原型系统。在户外开阔场地，通过控制大疆Mini系列等典型小型无人机进行多场景（如顺光、逆光、不同距离）的实地飞行测试，采集真实视频流进行实时推理，以帧率（FPS）、平均精度（mAP）及误检率为指标，定量评估算法在真实环境下的性能与鲁棒性，完成从理论到实践的闭环验证。

侧重无人机识别算法，而忽略了图像输入的相关增强算法

## **笔记**

## 20251010 机器学习&深度学习初步学习；文献初步阅读（YOLO）

两者区别—**特征处理**：

机器学习：人工处理设计特征

深度学习：不需要太多的特征输入，适合用在**难提取特征**的图像、语音、自然语言领域

深度学习的应用场景：图像识别、自然语言处理技术（机器翻译、文本识别、聊天对话）、语音技术 复杂图像处理

###  神经网络（AN||NN）

![image-20251010201210404](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251010201210404.png)

神经元包含激活函数

**数据、计算、算法**

### 逻辑回归 

sigmoid函数

![image-20251010203106958](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251010203106958.png)

![image-20251010203353285](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251010203353285.png)

![image-20251010203537569](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251010203537569.png)

输出P（y=1|x）



### YOLOv1:Unified  architecture 统一架构

核心创新点：统一架构处理速度极快：每秒45帧实时处理图像

fast R-CNN 的背景误差比YOLO的大

## 20251011 深度学习&&YOLOv1文献阅读

### **损失函数**

衡量预测结构与真实值之间的误差

平方损失不常用 因为有多个局部最小点

![image-20251011141616065](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251011141616065.png)

衡量了单个训练样本上的表现

多个样本的平均损失值

![image-20251011141742305](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251011141742305.png)

### **梯度下降算法：使损失函数的值找到最小值**

![image-20251011142211338](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251011142211338.png)

单个卷积网络同时预测多 个边界框和这些框的类概率

## 20251013 深度学习&YOLOv1&pytorch环境配置

#### 链式法则：导数连续影响

#### 逻辑回归的梯度下降

导数计算后，根据梯度下降公式更新参数

#### 向量化编程

m个样本：循环m个样本，每个样本计算一次参数的梯度，求和再求平均值，更新

**Numpy可以进行更加快速的向量化计算**（for循环耗时长）

**np.dot**(向量化计算)

![image-20251013143202425](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251013143202425.png)

#### 向量化实现

每个样本都放入一个矩阵中

#### 正向传播&反向传播

![image-20251013144119896](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251013144119896.png)

#### YOLOv1

![image-20251013145726579](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251013145726579.png)

## 20251016 YOLOv1&深度学习&pytorch环境配置

YOLO将目标检测重新定义为一个**单一的回归问题**，直接从输入图像像素预测出边界框（Bounding Box）和类别概率。它摒弃了当时主流方法（如R-CNN系列）复杂的多阶段流程（区域提议、分类、精修），实现了**端到端的统一检测框架**。

### Bounding Box

他们用于定义对象在图像中的位置，本质上是一个包围对象的矩形，帮助模型识别和定位；通常由一组坐标组成，这些坐标指示矩阵的位置和大小

YOLO边界框格式（标准化cxcywh格式）将**中心坐标、宽度和高度每个值分别除以图像的宽度和高度**进行归一化

![image-20251016180819891](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251016180819891.png)

### IOU

是一个简单的测量标准，两个区域的重叠部分除以两个区域的集合部分得出的结果

![image-20251016181017329](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251016181017329.png)

### MAP（均值平均精度）

object detection中衡量检测精度的指标

![image-20251016181407728](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251016181407728.png)

### YOLOv1

统一架构：将输入图像划分为s*s的网格；每个网格单元负责预测b的边界框和c个类别的条件概率；网络最终输出一个s *s+（b * 5+c）的**张量** （统一的目标检测表示）

### 深度学习

#### 激活函数

![image-20251016201031351](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251016201031351.png)

#### 卷积神经网络CNN

![image-20251016201221410](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251016201221410.png)

#### 循环神经网络RNN

![image-20251016202148783](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251016202148783.png)

#### transformer模型

基于自注意力机制，摆脱了RNN的循环依赖，可以并行处理序列数据（RNN需逐时刻处理，transformer可同时处理所有位置）

#### 生成对抗网络

通过生成器和判别器的相互对抗，让生成器学会生成“逼真的数据”

![image-20251016202434084](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251016202434084.png)

#### 深度强化学习DRL

让agent在环境中通过试错学习最优决策策略

#### 深度学习的训练流程

![image-20251016202915607](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251016202915607.png)

![image-20251016202925404](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251016202925404.png)

## 20251020 pytorch基础&深度学习

![image-20251020145415054](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251020145415054.png)

![image-20251020151303388](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251020151303388.png)

cmd与pycharm已经在使用同一个Python解释器

![image-20251020152751925](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251020152751925.png)

### 改变形状

![image-20251020202930907](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251020202930907.png)

### 广播机制（broadcasting）

![image-20251020203225481](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251020203225481.png)

先适当复制元素使这两个`Tensor`形状相同后再按元素运算。

### 梯度

![image-20251020204727461](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251020204727461.png)

## 20251021 pytorch&深度学习

## 线性回归

$$
\hat{y}=x_1w_1+x_2w_2+b
$$

w1和w2是权重，b是偏差，且均为标量

### Model Training

#### 训练数据

线性回归模型的房屋价格预测表达式
$$
\hat{y}^{(i)}=x_1^{(i)}w_1+x_2^{(i)}w_2+b
$$
采集样本为n，索引为i的样本

#### 损失函数(loss function)

衡量预测值与真实值之间的误差，常用平方函数(平方损失)
$$
ℓ^{（i）}(w_1,w_2,b)=\frac12(\hat{y}^{(i)}-y^{(i)})^2
$$
通常，我们用训练数据集中所有样本误差的平均来衡量模型预测的质量
$$
ℓ(w_1,w_2,b)=\frac1n\sum_{i=1}^{n}ℓ^{（i）}(w_1,w_2,b)=\frac1n\sum_{i=1}^{n}\frac12(x_1^{(i)}w_1+x_2^{(i)}w_2+b-y^{(i)})^2
$$
找出一组模型数据参数，使训练样本平均损失最小
$$
w_1^{*},w_2^{*},b^{*}=argmin_{w_1,w_2,b}ℓ(w_1,w_2,b)
$$

#### 优化算法

当模型和损失函数形式较为简单时，上面的误差最小化问题的解可以直接用公式表达出来。这类解叫作**解析解**（**analytical solution**）。本节使用的线性回归和平方误差刚好属于这个范畴。然而，大多数深度学习模型并**没有解析解**，只能通过**优化算法**有限次迭代模型参数来尽可能降低损失函数的值。这类解叫作**数值解**（**numerical solution**）。

##### 小批量随机梯度下降（minibatch stochastic gradient descent）

它的算法很简单：先选取一组模型参数的初始值，如随机选取；接下来对参数进行多次迭代，使每次迭代都可能降低损失函数的值。在每次迭代中，先随机均匀采样一个由固定数目训练数据样本所组成的小批量（mini-batch）BB，然后求小批量中数据样本的平均损失有关模型参数的导数（梯度），最后用此结果与预先设定的一个正数的乘积作为模型参数在本次迭代的减小量。

### 线性回归的表示方法

#### 神经网络图

![img](https://tangshusen.me/Dive-into-DL-PyTorch/img/chapter03/3.1_linreg.svg)

在图所示的神经网络中，输入分别为 x1*x*1 和 x2*x*2，因此输入层的输入个数为2。输入个数也叫特征数或特征向量维度。图中网络的输出为 o，输出层的输出个数为1。需要注意的是，我们直接将图中神经网络的输出 o作为线性回归的输出，即yˆ=o 。由于**输入层并不涉及计算**，**按照惯例，图所示的神经网络的层数为1**。所以，**线性回归是一个单层神经网络**。输出层中负责计算 o的单元又叫**神经元**。在线性回归中，o的计算依赖于 x1*x*1 和 x2*x*2。也就是说，**输出层中的神经元和输入层中各个输入完全连接**。因此，这里的输出层又叫**全连接层**（fully-connected layer）或**稠密层**（dense layer）。

#### 矢量计算表达式

![image-20251021144321489](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251021144321489.png)

两个向量按元素逐一做标量加法

![image-20251021144459378](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251021144459378.png)

矢量加法

### 小结

- 和大多数深度学习模型一样，对于线性回归这样一种**单层神经网络**，它的基本要素包括**模型**、**训练数据**、**损失函数**和**优化算法**。
- 既可以用神经网络图表示线性回归，又可以用矢量计算表示该模型。
- 应该尽可能采用**矢量计算**，以提升计算效率。

## 实现线性回归

### 生成数据集

![image-20251022192713770](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251022192713770.png)

### 读取数据

![image-20251022193458253](C:\Users\Ww\AppData\Roaming\Typora\typora-user-images\image-20251022193458253.png)
